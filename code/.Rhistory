annotate(label = paste0("temperature = ", dat$temp_group[1]), geom = "text",
x = mean(dat$tlag), y = max(dat$rmax), hjust = 0, vjust = 0, size = 2.5)
}
pdf(file = "../results/rt_plot/log_rt_temp")
ggarrange(plotrt(df1), plotrt(df2), plotrt(df3), plotrt(df4),
#labels = paste(df1$temp_group,df2$temp_group,df3$temp_group,df4$temp_group),
ncol = 1, nrow = 4)
graphics.off()
##################################
# r_max V.S. t_lag by temperature#
##################################
# 1. plot tlag VS rmax grouped by temp
plotrt <- function(dat){
ggplot(data = dat, aes(x = log(tlag), y = log(rmax)),
ylim(min(log(rmax)), max(log(rmax))+3)) +
geom_smooth(method = "lm", se=TRUE, color="black", formula = y ~ x) +
geom_point()+
stat_cor(label.y = max(dat$rmax, na.rm = TRUE)+1, size = 2)+ #this means at 35th unit in the y axis, the r squared and p value will be shown
stat_regline_equation(label.y = max(dat$rmax, na.rm = TRUE)+1.3, size = 2) +
annotate(label = paste0("temperature = ", dat$temp_group[1]), geom = "text",
x = mean(dat$tlag), y = max(dat$rmax), hjust = -2, vjust = 0, size = 2.5)
}
pdf(file = "../results/rt_plot/log_rt_temp")
ggarrange(plotrt(df1), plotrt(df2), plotrt(df3), plotrt(df4),
#labels = paste(df1$temp_group,df2$temp_group,df3$temp_group,df4$temp_group),
ncol = 1, nrow = 4)
graphics.off()
##################################
# r_max V.S. t_lag by temperature#
##################################
# 1. plot tlag VS rmax grouped by temp
plotrt <- function(dat){
ggplot(data = dat, aes(x = log(tlag), y = log(rmax)),
ylim(min(log(rmax)), max(log(rmax))+3)) +
geom_smooth(method = "lm", se=TRUE, color="black", formula = y ~ x) +
geom_point()+
stat_cor(label.y = max(dat$rmax, na.rm = TRUE)+1, size = 2)+ #this means at 35th unit in the y axis, the r squared and p value will be shown
stat_regline_equation(label.y = max(dat$rmax, na.rm = TRUE)+2, size = 2) +
annotate(label = paste0("temperature = ", dat$temp_group[1]), geom = "text",
x = mean(dat$tlag), y = max(dat$rmax), hjust = -1, vjust = 0, size = 2.5)
}
pdf(file = "../results/rt_plot/log_rt_temp")
ggarrange(plotrt(df1), plotrt(df2), plotrt(df3), plotrt(df4),
#labels = paste(df1$temp_group,df2$temp_group,df3$temp_group,df4$temp_group),
ncol = 1, nrow = 4)
graphics.off()
##################################
# r_max V.S. t_lag by temperature#
##################################
# 1. plot tlag VS rmax grouped by temp
plotrt <- function(dat){
ggplot(data = dat, aes(x = log(tlag), y = log(rmax)),
ylim(min(log(rmax)), max(log(rmax))+3)) +
geom_smooth(method = "lm", se=TRUE, color="black", formula = y ~ x) +
geom_point()+
stat_cor(label.y = max(dat$rmax, na.rm = TRUE)+1, size = 2)+ #this means at 35th unit in the y axis, the r squared and p value will be shown
stat_regline_equation(label.y = max(dat$rmax, na.rm = TRUE)+2, size = 2) +
annotate(label = paste0("temperature = ", dat$temp_group[1]), geom = "text",
x = mean(dat$tlag), y = max(dat$rmax), hjust = 0, vjust = 0, size = 2.5)
}
pdf(file = "../results/rt_plot/log_rt_temp")
ggarrange(plotrt(df1), plotrt(df2), plotrt(df3), plotrt(df4),
#labels = paste(df1$temp_group,df2$temp_group,df3$temp_group,df4$temp_group),
ncol = 1, nrow = 4)
graphics.off()
##################################
# r_max V.S. t_lag by temperature#
##################################
# 1. plot tlag VS rmax grouped by temp
plotrt <- function(dat){
ggplot(data = dat, aes(x = log(tlag), y = log(rmax)),
ylim(min(log(rmax)), max(log(rmax))+3)) +
geom_smooth(method = "lm", se=TRUE, color="black", formula = y ~ x) +
geom_point()+
stat_cor(label.y = max(dat$rmax, na.rm = TRUE)+1, size = 2)+ #this means at 35th unit in the y axis, the r squared and p value will be shown
stat_regline_equation(label.y = max(dat$rmax, na.rm = TRUE)+2, size = 2) +
annotate(label = paste0("temperature = ", dat$temp_group[1]), geom = "text",
x = mean(dat$tlag), y = max(dat$rmax), hjust = 1, vjust = 0, size = 2.5)
}
pdf(file = "../results/rt_plot/log_rt_temp")
ggarrange(plotrt(df1), plotrt(df2), plotrt(df3), plotrt(df4),
#labels = paste(df1$temp_group,df2$temp_group,df3$temp_group,df4$temp_group),
ncol = 1, nrow = 4)
graphics.off()
##################################
# r_max V.S. t_lag by temperature#
##################################
# 1. plot tlag VS rmax grouped by temp
plotrt <- function(dat){
ggplot(data = dat, aes(x = log(tlag), y = log(rmax)),
ylim(min(log(rmax)), max(log(rmax))+3)) +
geom_smooth(method = "lm", se=TRUE, color="black", formula = y ~ x) +
geom_point()+
stat_cor(label.y = max(dat$rmax, na.rm = TRUE)+1, size = 2)+ #this means at 35th unit in the y axis, the r squared and p value will be shown
stat_regline_equation(label.y = max(dat$rmax, na.rm = TRUE)+2, size = 2) +
annotate(label = paste0("temperature = ", dat$temp_group[1]), geom = "text",
x = mean(dat$tlag), y = max(dat$rmax), hjust = 2, vjust = 0, size = 2.5)
}
pdf(file = "../results/rt_plot/log_rt_temp")
ggarrange(plotrt(df1), plotrt(df2), plotrt(df3), plotrt(df4),
#labels = paste(df1$temp_group,df2$temp_group,df3$temp_group,df4$temp_group),
ncol = 1, nrow = 4)
graphics.off()
##################################
# r_max V.S. t_lag by temperature#
##################################
# 1. plot tlag VS rmax grouped by temp
plotrt <- function(dat){
ggplot(data = dat, aes(x = log(tlag), y = log(rmax)),
ylim(min(log(rmax)), max(log(rmax))+3)) +
geom_smooth(method = "lm", se=TRUE, color="black", formula = y ~ x) +
geom_point()+
stat_cor(label.y = max(dat$rmax, na.rm = TRUE)+1, size = 2)+ #this means at 35th unit in the y axis, the r squared and p value will be shown
stat_regline_equation(label.y = max(dat$rmax, na.rm = TRUE)+2, size = 2) +
annotate(label = paste0("temperature = ", dat$temp_group[1]), geom = "text",
x = mean(dat$tlag), y = max(dat$rmax), hjust = 5, vjust = 0, size = 2.5)
}
pdf(file = "../results/rt_plot/log_rt_temp")
ggarrange(plotrt(df1), plotrt(df2), plotrt(df3), plotrt(df4),
#labels = paste(df1$temp_group,df2$temp_group,df3$temp_group,df4$temp_group),
ncol = 1, nrow = 4)
graphics.off()
##################################
# r_max V.S. t_lag by temperature#
##################################
# 1. plot tlag VS rmax grouped by temp
plotrt <- function(dat){
ggplot(data = dat, aes(x = log(tlag), y = log(rmax))
#,xlim(min(log(tlag)), max(log(tlag))+3)
) +
geom_smooth(method = "lm", se=TRUE, color="black", formula = y ~ x) +
geom_point()+
stat_cor(label.y = max(dat$rmax, na.rm = TRUE)+1, size = 2)+ #this means at 35th unit in the y axis, the r squared and p value will be shown
stat_regline_equation(label.y = max(dat$rmax, na.rm = TRUE)+2, size = 2) +
annotate(label = paste0("temperature = ", dat$temp_group[1]), geom = "text",
x = mean(dat$tlag), y = max(dat$rmax), hjust = 5, vjust = 0, size = 2.5)
}
pdf(file = "../results/rt_plot/log_rt_temp")
ggarrange(plotrt(df1), plotrt(df2), plotrt(df3), plotrt(df4),
#labels = paste(df1$temp_group,df2$temp_group,df3$temp_group,df4$temp_group),
ncol = 1, nrow = 4)
graphics.off()
##################################
# r_max V.S. t_lag by temperature#
##################################
# 1. plot tlag VS rmax grouped by temp
plotrt <- function(dat){
ggplot(data = dat, aes(x = log(tlag), y = log(rmax))
,xlim(min(log(tlag)), max(log(tlag)))
) +
geom_smooth(method = "lm", se=TRUE, color="black", formula = y ~ x) +
geom_point()+
stat_cor(label.y = max(dat$rmax, na.rm = TRUE)+1, size = 2)+ #this means at 35th unit in the y axis, the r squared and p value will be shown
stat_regline_equation(label.y = max(dat$rmax, na.rm = TRUE)+2, size = 2) +
annotate(label = paste0("temperature = ", dat$temp_group[1]), geom = "text",
x = mean(dat$tlag), y = max(dat$rmax), hjust = 5, vjust = 0, size = 2.5)
}
pdf(file = "../results/rt_plot/log_rt_temp")
ggarrange(plotrt(df1), plotrt(df2), plotrt(df3), plotrt(df4),
#labels = paste(df1$temp_group,df2$temp_group,df3$temp_group,df4$temp_group),
ncol = 1, nrow = 4)
graphics.off()
plotrt(df1)
##################################
# r_max V.S. t_lag by temperature#
##################################
# 1. plot tlag VS rmax grouped by temp
plotrt <- function(dat){
ggplot(data = dat, aes(x = log(tlag), y = log(rmax))
#,xlim(min(log(tlag)), max(log(tlag)))
) +
geom_smooth(method = "lm", se=TRUE, color="black", formula = y ~ x) +
geom_point()+
stat_cor(label.y = max(dat$rmax, na.rm = TRUE)+1, size = 2)+ #this means at 35th unit in the y axis, the r squared and p value will be shown
stat_regline_equation(label.y = max(dat$rmax, na.rm = TRUE)+2, size = 2) +
annotate(label = paste0("temperature = ", dat$temp_group[1]), geom = "text",
x = mean(dat$tlag), y = max(dat$rmax)
#, hjust = 5, vjust = 0,
size = 2.5)
}
##################################
# r_max V.S. t_lag by temperature#
##################################
# 1. plot tlag VS rmax grouped by temp
plotrt <- function(dat){
ggplot(data = dat, aes(x = log(tlag), y = log(rmax))
#,xlim(min(log(tlag)), max(log(tlag)))
) +
geom_smooth(method = "lm", se=TRUE, color="black", formula = y ~ x) +
geom_point()+
stat_cor(label.y = max(dat$rmax, na.rm = TRUE)+1, size = 2)+ #this means at 35th unit in the y axis, the r squared and p value will be shown
stat_regline_equation(label.y = max(dat$rmax, na.rm = TRUE)+2, size = 2) +
annotate(label = paste0("temperature = ", dat$temp_group[1]), geom = "text",
x = mean(dat$tlag), y = max(dat$rmax),
#hjust = 5, vjust = 0,
size = 2.5)
}
plotrt(df1)
##################################
# r_max V.S. t_lag by temperature#
##################################
# 1. plot tlag VS rmax grouped by temp
plotrt <- function(dat){
ggplot(data = dat, aes(x = log(tlag), y = log(rmax))
#,xlim(min(log(tlag)), max(log(tlag)))
) +
geom_smooth(method = "lm", se=TRUE, color="black", formula = y ~ x) +
geom_point()+
stat_cor(label.y = max(dat$rmax, na.rm = TRUE)+1, size = 2)+ #this means at 35th unit in the y axis, the r squared and p value will be shown
stat_regline_equation(label.y = max(dat$rmax, na.rm = TRUE)+2, size = 2) +
annotate(label = paste0("temperature = ", dat$temp_group[1]), geom = "text",
x = mean(dat$tlag), y = max(dat$rmax),
hjust = 5, vjust = 0,
size = 2.5)
}
plotrt(df1)
##################################
# r_max V.S. t_lag by temperature#
##################################
# 1. plot tlag VS rmax grouped by temp
plotrt <- function(dat){
ggplot(data = dat, aes(x = log(tlag), y = log(rmax))
#,xlim(min(log(tlag)), max(log(tlag)))
) +
geom_smooth(method = "lm", se=TRUE, color="black", formula = y ~ x) +
geom_point()+
stat_cor(label.y = max(dat$rmax, na.rm = TRUE)+1, size = 2)+ #this means at 35th unit in the y axis, the r squared and p value will be shown
stat_regline_equation(label.y = max(dat$rmax, na.rm = TRUE)+2, size = 2) +
annotate(label = paste0("temperature = ", dat$temp_group[1]), geom = "text",
x = mean(dat$tlag), y = max(dat$rmax),
hjust = 7, vjust = 0,
size = 2.5)
}
plotrt(df1)
##################################
# r_max V.S. t_lag by temperature#
##################################
# 1. plot tlag VS rmax grouped by temp
plotrt <- function(dat){
ggplot(data = dat, aes(x = log(tlag), y = log(rmax))
#,xlim(min(log(tlag)), max(log(tlag)))
) +
geom_smooth(method = "lm", se=TRUE, color="black", formula = y ~ x) +
geom_point()+
stat_cor(label.y = max(dat$rmax, na.rm = TRUE)+1, size = 2)+ #this means at 35th unit in the y axis, the r squared and p value will be shown
stat_regline_equation(label.y = max(dat$rmax, na.rm = TRUE)+2, size = 2) +
annotate(label = paste0("temperature = ", dat$temp_group[1]), geom = "text",
x = mean(dat$tlag), y = max(dat$rmax),
hjust = 11, vjust = 0,
size = 2.5)
}
plotrt(df1)
##################################
# r_max V.S. t_lag by temperature#
##################################
# 1. plot tlag VS rmax grouped by temp
plotrt <- function(dat){
ggplot(data = dat, aes(x = log(tlag), y = log(rmax))
#,xlim(min(log(tlag)), max(log(tlag)))
) +
geom_smooth(method = "lm", se=TRUE, color="black", formula = y ~ x) +
geom_point()+
stat_cor(label.y = max(dat$rmax, na.rm = TRUE)+1, size = 2)+ #this means at 35th unit in the y axis, the r squared and p value will be shown
stat_regline_equation(label.y = max(dat$rmax, na.rm = TRUE)+2, size = 2) +
annotate(label = paste0("temperature = ", dat$temp_group[1]), geom = "text",
x = mean(dat$tlag), y = max(dat$rmax),
hjust = 0, vjust = 0,
size = 2.5)
}
plotrt(df1)
##################################
# r_max V.S. t_lag by temperature#
##################################
# 1. plot tlag VS rmax grouped by temp
plotrt <- function(dat){
ggplot(data = dat, aes(x = log(tlag), y = log(rmax))
#,xlim(min(log(tlag)), max(log(tlag)))
) +
geom_smooth(method = "lm", se=TRUE, color="black", formula = y ~ x) +
geom_point()+
stat_cor(label.y = max(dat$rmax, na.rm = TRUE)+1, size = 2)+ #this means at 35th unit in the y axis, the r squared and p value will be shown
stat_regline_equation(label.y = max(dat$rmax, na.rm = TRUE)+2, size = 2) +
annotate(label = paste0("temperature = ", dat$temp_group[1]), geom = "text",
x = mean(dat$tlag), y = max(dat$rmax),
hjust = 7, vjust = 0,
size = 2.5)
}
plotrt(df1)
##################################
# r_max V.S. t_lag by temperature#
##################################
# 1. plot tlag VS rmax grouped by temp
plotrt <- function(dat){
ggplot(data = dat, aes(x = log(tlag), y = log(rmax))
#,xlim(min(log(tlag)), max(log(tlag)))
) +
geom_smooth(method = "lm", se=TRUE, color="black", formula = y ~ x) +
geom_point()+
stat_cor(label.y = max(dat$rmax, na.rm = TRUE)+1, size = 2)+ #this means at 35th unit in the y axis, the r squared and p value will be shown
stat_regline_equation(label.y = max(dat$rmax, na.rm = TRUE)+2, size = 2) +
# annotate(label = paste0("temperature = ", dat$temp_group[1]), geom = "text",
#          x = mean(dat$tlag), y = max(dat$rmax),
#          hjust = 7, vjust = 0,
#          size = 2.5)
}
##################################
# r_max V.S. t_lag by temperature#
##################################
# 1. plot tlag VS rmax grouped by temp
plotrt <- function(dat){
ggplot(data = dat, aes(x = log(tlag), y = log(rmax))
#,xlim(min(log(tlag)), max(log(tlag)))
) +
geom_smooth(method = "lm", se=TRUE, color="black", formula = y ~ x) +
geom_point()+
stat_cor(label.y = max(dat$rmax, na.rm = TRUE)+1, size = 2)+ #this means at 35th unit in the y axis, the r squared and p value will be shown
stat_regline_equation(label.y = max(dat$rmax, na.rm = TRUE)+2, size = 2)
# annotate(label = paste0("temperature = ", dat$temp_group[1]), geom = "text",
#          x = mean(dat$tlag), y = max(dat$rmax),
#          hjust = 7, vjust = 0,
#          size = 2.5)
}
plotrt(df1)
##################################
# r_max V.S. t_lag by temperature#
##################################
# 1. plot tlag VS rmax grouped by temp
plotrt <- function(dat){
ggplot(data = dat, aes(x = log(tlag), y = log(rmax))
#,xlim(min(log(tlag)), max(log(tlag)))
) +
geom_smooth(method = "lm", se=TRUE, color="black", formula = y ~ x) +
geom_point()+
stat_cor(label.y = max(dat$rmax, na.rm = TRUE)+1, size = 2)+ #this means at 35th unit in the y axis, the r squared and p value will be shown
stat_regline_equation(label.y = max(dat$rmax, na.rm = TRUE)+2, size = 2)
annotate(label = paste0("temperature = ", dat$temp_group[1]), geom = "text",
x = min(dat$tlag), y = max(dat$rmax),
hjust = 3, vjust = 0,
size = 2.5)
}
plotrt(df1)
plotrt(df1)
##################################
# r_max V.S. t_lag by temperature#
##################################
# 1. plot tlag VS rmax grouped by temp
plotrt <- function(dat){
ggplot(data = dat, aes(x = log(tlag), y = log(rmax))
#,xlim(min(log(tlag)), max(log(tlag)))
) +
geom_smooth(method = "lm", se=TRUE, color="black", formula = y ~ x) +
geom_point()+
stat_cor(label.y = max(dat$rmax, na.rm = TRUE)+1, size = 2)+ #this means at 35th unit in the y axis, the r squared and p value will be shown
stat_regline_equation(label.y = max(dat$rmax, na.rm = TRUE)+2, size = 2)
annotate(label = paste0("temperature = ", dat$temp_group[1]), geom = "text",
x = min(dat$tlag), y = max(dat$rmax),
hjust = 3, vjust = 0,
size = 2.5)
}
plotrt(df1)
##################################
# r_max V.S. t_lag by temperature#
##################################
# 1. plot tlag VS rmax grouped by temp
plotrt <- function(dat){
ggplot(data = dat, aes(x = log(tlag), y = log(rmax))
#,xlim(min(log(tlag)), max(log(tlag)))
) +
geom_smooth(method = "lm", se=TRUE, color="black", formula = y ~ x) +
geom_point()+
stat_cor(label.y = max(dat$rmax, na.rm = TRUE)+1, size = 2)+ #this means at 35th unit in the y axis, the r squared and p value will be shown
stat_regline_equation(label.y = max(dat$rmax, na.rm = TRUE)+2, size = 2)
annotate(label = paste0("temperature = ", dat$temp_group[1]), geom = "text",
x = min(dat$tlag,na.rm = TRUE), y = max(dat$rmax, na.rm = TRUE),
hjust = 3, vjust = 0,
size = 2.5)
}
plotrt(df1)
##################################
# r_max V.S. t_lag by temperature#
##################################
# 1. plot tlag VS rmax grouped by temp
plotrt <- function(dat){
ggplot(data = dat, aes(x = log(tlag), y = log(rmax))
#,xlim(min(log(tlag)), max(log(tlag)))
) +
geom_smooth(method = "lm", se=TRUE, color="black", formula = y ~ x) +
geom_point()+
stat_cor(label.y = max(dat$rmax, na.rm = TRUE)+1, size = 2)+ #this means at 35th unit in the y axis, the r squared and p value will be shown
stat_regline_equation(label.y = max(dat$rmax, na.rm = TRUE)+2, size = 2)
annotate(label = paste0("temperature = ", dat$temp_group[1]), geom = "text",
x = min(dat$tlag,na.rm = TRUE), y = max(dat$rmax, na.rm = TRUE),
hjust = 3, vjust = 0,
size = 2.5)
}
plotrt(df1
)
graphics.off()
plotrt(df1)
##################################
# r_max V.S. t_lag by temperature#
##################################
# 1. plot tlag VS rmax grouped by temp
plotrt <- function(dat){
ggplot(data = dat, aes(x = log(tlag), y = log(rmax))
,xlim(min(log(tlag)), max(log(tlag)))
) +
geom_smooth(method = "lm", se=TRUE, color="black", formula = y ~ x) +
geom_point()+
stat_cor(label.y = max(dat$rmax, na.rm = TRUE)+1, size = 2)+ #this means at 35th unit in the y axis, the r squared and p value will be shown
stat_regline_equation(label.y = max(dat$rmax, na.rm = TRUE)+2, size = 2)
annotate(label = paste0("temperature = ", dat$temp_group[1]), geom = "text",
x = min(dat$tlag,na.rm = TRUE), y = max(dat$rmax, na.rm = TRUE),
hjust = 3, vjust = 0,
size = 2.5)
}
plotrt(df1)
##################################
# r_max V.S. t_lag by temperature#
##################################
# 1. plot tlag VS rmax grouped by temp
plotrt <- function(dat){
ggplot(data = dat, aes(x = log(tlag), y = log(rmax))
,xlim(min(log(tlag)), max(log(tlag)))
) +
geom_smooth(method = "lm", se=TRUE, color="black", formula = y ~ x) +
geom_point()+
stat_cor(label.y = max(dat$rmax, na.rm = TRUE)+1, size = 2)+ #this means at 35th unit in the y axis, the r squared and p value will be shown
stat_regline_equation(label.y = max(dat$rmax, na.rm = TRUE)+2, size = 2)
annotate(label = paste0("temperature = ", dat$temp_group[1]), geom = "text",
x = min(dat$tlag,na.rm = TRUE), y = max(dat$rmax, na.rm = TRUE),
hjust = 3, vjust = 0,
size = 2.5)
}
plotrt(df1)
ggplot(data = df1, aes(x = log(tlag), y = log(rmax))
,xlim(min(log(tlag)), max(log(tlag)))
) +
geom_smooth(method = "lm", se=TRUE, color="black", formula = y ~ x) +
geom_point()+
stat_cor(label.y = max(df1$rmax, na.rm = TRUE)+1, size = 2)+ #this means at 35th unit in the y axis, the r squared and p value will be shown
stat_regline_equation(label.y = max(df1$rmax, na.rm = TRUE)+2, size = 2)
ggplot(data = df1, aes(x = log(tlag), y = log(rmax))
,xlim(min(log(tlag)), max(log(tlag)))
) +
geom_smooth(method = "lm", se=TRUE, color="black", formula = y ~ x) +
geom_point()+
stat_cor(label.y = max(df1$rmax, na.rm = TRUE)+1, size = 2)+ #this means at 35th unit in the y axis, the r squared and p value will be shown
stat_regline_equation(label.y = max(df1$rmax, na.rm = TRUE)+2, size = 2)
##################################
# r_max V.S. t_lag by temperature#
##################################
# 1. plot tlag VS rmax grouped by temp
plotrt <- function(dat){
ggplot(data = dat, aes(x = log(tlag), y = log(rmax))
,xlim(min(log(tlag)), max(log(tlag)))
) +
geom_smooth(method = "lm", se=TRUE, color="black", formula = y ~ x) +
geom_point()+
stat_cor(label.y = max(dat$rmax, na.rm = TRUE)+1, size = 2)+ #this means at 35th unit in the y axis, the r squared and p value will be shown
stat_regline_equation(label.y = max(dat$rmax, na.rm = TRUE)+2, size = 2) +
annotate(label = paste0("temperature = ", dat$temp_group[1]), geom = "text",
x = min(dat$tlag,na.rm = TRUE), y = max(dat$rmax, na.rm = TRUE),
hjust = 3, vjust = 0,
size = 2.5)
}
plotrt(df1)
##################################
# r_max V.S. t_lag by temperature#
##################################
# 1. plot tlag VS rmax grouped by temp
plotrt <- function(dat){
ggplot(data = dat, aes(x = log(tlag), y = log(rmax))
,xlim(min(log(tlag)), max(log(tlag)))
) +
geom_smooth(method = "lm", se=TRUE, color="black", formula = y ~ x) +
geom_point()+
stat_cor(label.y = max(dat$rmax, na.rm = TRUE)+1, size = 2)+ #this means at 35th unit in the y axis, the r squared and p value will be shown
stat_regline_equation(label.y = max(dat$rmax, na.rm = TRUE)+2, size = 2) +
annotate(label = paste0("temperature = ", dat$temp_group[1]), geom = "text",
x = min(dat$tlag,na.rm = TRUE), y = max(dat$rmax, na.rm = TRUE),
hjust = 0, vjust = 0,
size = 2.5)
}
plotrt(df1)
pdf(file = "../results/rt_plot/log_rt_temp")
ggarrange(plotrt(df1), plotrt(df2), plotrt(df3), plotrt(df4),
#labels = paste(df1$temp_group,df2$temp_group,df3$temp_group,df4$temp_group),
ncol = 1, nrow = 4)
graphics.off()
##################################
# r_max V.S. t_lag by temperature#
##################################
# 1. plot tlag VS rmax grouped by temp
plotrt <- function(dat){
ggplot(data = dat, aes(x = log(tlag), y = log(rmax))
,xlim(min(log(tlag)), max(log(tlag)))
) +
geom_smooth(method = "lm", se=TRUE, color="black", formula = y ~ x) +
geom_point()+
stat_cor(label.y = max(dat$rmax, na.rm = TRUE)+1, size = 2)+ #this means at 35th unit in the y axis, the r squared and p value will be shown
stat_regline_equation(label.y = max(dat$rmax, na.rm = TRUE)+2.3, size = 2) +
annotate(label = paste0("temperature = ", dat$temp_group[1]), geom = "text",
x = min(dat$tlag,na.rm = TRUE), y = max(dat$rmax, na.rm = TRUE),
hjust = 0, vjust = 0,
size = 2.5)
}
pdf(file = "../results/rt_plot/log_rt_temp")
ggarrange(plotrt(df1), plotrt(df2), plotrt(df3), plotrt(df4),
#labels = paste(df1$temp_group,df2$temp_group,df3$temp_group,df4$temp_group),
ncol = 1, nrow = 4)
graphics.off()
