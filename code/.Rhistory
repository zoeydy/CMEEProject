plot(-1/(K*(273.15+typ.mean$temp.c)), typ.mean$mean.log.r)
#plot(-1/(K*(273.15+typ.mean$temp.c)), typ.mean$mean.log.r)
ggplot(data = typ.mean, aes(x = 1/(K*(273.15+temp.c)), y = mean.log.r)) +
geom_point() +
theme_set(theme_bw()) +
theme_classic() +
theme(panel.grid.major = element_line(colour = NA), panel.border = element_blank(),
axis.title.x = element_text(size = 17),
axis.title.y = element_text(size = 17)) +
stat_smooth(data = typ.mean[typ.mean$temp.c <= 30,],method = 'lm', formula = 'y~x',se = FALSE) +
stat_poly_eq(formula = y~x,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
geom_ribbon(data = typ.mean[typ.mean$temp.c >= 30,],aes(ymin = -Inf, ymax = Inf), colour = "grey", alpha = 0.5) +
xlab("1/(K T)")+
ylab("log of metabolic trait")
#plot(-1/(K*(273.15+typ.mean$temp.c)), typ.mean$mean.log.r)
ggplot(data = typ.mean, aes(x = 1/(K*(273.15+temp.c)), y = mean.log.r)) +
geom_point() +
theme_set(theme_bw()) +
theme_classic() +
theme(panel.grid.major = element_line(colour = NA), panel.border = element_blank(),
axis.title.x = element_text(size = 17),
axis.title.y = element_text(size = 17)) +
stat_smooth(data = typ.mean[typ.mean$temp.c <= 30,],method = 'lm', formula = 'y~x',se = FALSE) +
stat_poly_eq(formula = y~x,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
geom_ribbon(data = typ.mean[typ.mean$temp.c >= 30,],aes(ymin = -Inf, ymax = Inf), colour = "grey", alpha = 0.5) +
xlab("1/(K T)")+
ylab("log of metabolic trait")
lm_eqn <- function(typ.mean){
m <- lm(y ~ x, df);
eq <- substitute(italic(y) == a + b %.% italic(x)*","~~italic(r)^2~"="~r2,
list(a = format(unname(coef(m)[1]), digits = 2),
b = format(unname(coef(m)[2]), digits = 2),
r2 = format(summary(m)$r.squared, digits = 3)))
as.character(as.expression(eq));
}
lm_eqn <- function(df){
m <- lm(y ~ x, df);
eq <- substitute(italic(y) == a + b %.% italic(x)*","~~italic(r)^2~"="~r2,
list(a = format(unname(coef(m)[1]), digits = 2),
b = format(unname(coef(m)[2]), digits = 2),
r2 = format(summary(m)$r.squared, digits = 3)))
as.character(as.expression(eq));
}
#plot(-1/(K*(273.15+typ.mean$temp.c)), typ.mean$mean.log.r)
ggplot(data = typ.mean, aes(x = 1/(K*(273.15+temp.c)), y = mean.log.r)) +
geom_point() +
theme_set(theme_bw()) +
theme_classic() +
theme(panel.grid.major = element_line(colour = NA), panel.border = element_blank(),
axis.title.x = element_text(size = 17),
axis.title.y = element_text(size = 17)) +
stat_smooth(data = typ.mean[typ.mean$temp.c <= 30,],method = 'lm', formula = 'y~x',se = FALSE) +
geom_text(x = -40, y = 0.5, label = lm_eqn(typ.mean), parse = TRUE) +
geom_ribbon(data = typ.mean[typ.mean$temp.c >= 30,],aes(ymin = -Inf, ymax = Inf), colour = "grey", alpha = 0.5) +
xlab("1/(K T)")+
ylab("log of metabolic trait")
lm_eqn(typ.mean)
lm(y ~ x, typ.mean)
lm_eqn <- function(df){
m <- fit.r.spe;
eq <- substitute(italic(y) == a + b %.% italic(x)*","~~italic(r)^2~"="~r2,
list(a = format(unname(coef(m)[1]), digits = 2),
b = format(unname(coef(m)[2]), digits = 2),
r2 = format(summary(m)$r.squared, digits = 3)))
as.character(as.expression(eq));
}
lm_eqn(typ.mean)
#plot(-1/(K*(273.15+typ.mean$temp.c)), typ.mean$mean.log.r)
ggplot(data = typ.mean, aes(x = 1/(K*(273.15+temp.c)), y = mean.log.r)) +
geom_point() +
theme_set(theme_bw()) +
theme_classic() +
theme(panel.grid.major = element_line(colour = NA), panel.border = element_blank(),
axis.title.x = element_text(size = 17),
axis.title.y = element_text(size = 17)) +
stat_smooth(data = typ.mean[typ.mean$temp.c <= 30,],method = 'lm', formula = 'y~x',se = FALSE) +
geom_text(x = -40, y = 0.5, label = lm_eqn(typ.mean), parse = TRUE) +
geom_ribbon(data = typ.mean[typ.mean$temp.c >= 30,],aes(ymin = -Inf, ymax = Inf), colour = "grey", alpha = 0.5) +
xlab("1/(K T)")+
ylab("log of metabolic trait")
#plot(-1/(K*(273.15+typ.mean$temp.c)), typ.mean$mean.log.r)
ggplot(data = typ.mean, aes(x = 1/(K*(273.15+temp.c)), y = mean.log.r)) +
geom_point() +
theme_set(theme_bw()) +
theme_classic() +
theme(panel.grid.major = element_line(colour = NA), panel.border = element_blank(),
axis.title.x = element_text(size = 17),
axis.title.y = element_text(size = 17)) +
stat_smooth(data = typ.mean[typ.mean$temp.c <= 30,],method = 'lm', formula = 'y~x',se = FALSE) +
geom_text(x = 39.5, y = -5, label = lm_eqn(typ.mean), parse = TRUE) +
geom_ribbon(data = typ.mean[typ.mean$temp.c >= 30,],aes(ymin = -Inf, ymax = Inf), colour = "grey", alpha = 0.5) +
xlab("1/(K T)")+
ylab("log of metabolic trait")
fit.r.spe
lm_eqn <- function(df){
m <- fit.r.spe;
eq <- substitute(italic(y) == a + b %.% italic(x)*","~~italic(r)^2~"="~r2,
list(a = format(unname(-coef(m)[1]), digits = 2),
b = format(unname(coef(m)[2]), digits = 2),
r2 = format(summary(m)$r.squared, digits = 3)))
as.character(as.expression(eq));
}
#plot(-1/(K*(273.15+typ.mean$temp.c)), typ.mean$mean.log.r)
ggplot(data = typ.mean, aes(x = 1/(K*(273.15+temp.c)), y = mean.log.r)) +
geom_point() +
theme_set(theme_bw()) +
theme_classic() +
theme(panel.grid.major = element_line(colour = NA), panel.border = element_blank(),
axis.title.x = element_text(size = 17),
axis.title.y = element_text(size = 17)) +
stat_smooth(data = typ.mean[typ.mean$temp.c <= 30,],method = 'lm', formula = 'y~x',se = FALSE) +
geom_text(x = 39.5, y = -5, label = lm_eqn(typ.mean), parse = TRUE) +
geom_ribbon(data = typ.mean[typ.mean$temp.c >= 30,],aes(ymin = -Inf, ymax = Inf), colour = "grey", alpha = 0.5) +
xlab("1/(K T)")+
ylab("log of metabolic trait")
lm_eqn <- function(df){
m <- fit.r.spe;
eq <- substitute(italic(y) == a + b %.% italic(x)*","~~italic(r)^2~"="~r2,
list(a = format(unname(coef(m)[1]), digits = 2),
b = format(unname(-coef(m)[2]), digits = 2),
r2 = format(summary(m)$r.squared, digits = 3)))
as.character(as.expression(eq));
}
#plot(-1/(K*(273.15+typ.mean$temp.c)), typ.mean$mean.log.r)
ggplot(data = typ.mean, aes(x = 1/(K*(273.15+temp.c)), y = mean.log.r)) +
geom_point() +
theme_set(theme_bw()) +
theme_classic() +
theme(panel.grid.major = element_line(colour = NA), panel.border = element_blank(),
axis.title.x = element_text(size = 17),
axis.title.y = element_text(size = 17)) +
stat_smooth(data = typ.mean[typ.mean$temp.c <= 30,],method = 'lm', formula = 'y~x',se = FALSE) +
geom_text(x = 39.5, y = -5, label = lm_eqn(typ.mean), parse = TRUE) +
geom_ribbon(data = typ.mean[typ.mean$temp.c >= 30,],aes(ymin = -Inf, ymax = Inf), colour = "grey", alpha = 0.5) +
xlab("1/(K T)")+
ylab("log of metabolic trait")
#plot(-1/(K*(273.15+typ.mean$temp.c)), typ.mean$mean.log.r)
ggplot(data = typ.mean, aes(x = 1/(K*(273.15+temp.c)), y = mean.log.r)) +
geom_point() +
theme_set(theme_bw()) +
theme_classic() +
theme(panel.grid.major = element_line(colour = NA), panel.border = element_blank(),
axis.title.x = element_text(size = 17),
axis.title.y = element_text(size = 17)) +
stat_smooth(data = typ.mean[typ.mean$temp.c <= 30,],method = 'lm', formula = 'y~x',se = FALSE) +
geom_text(x = 39.5, y = -5, label = lm_eqn(typ.mean), parse = TRUE, size = 3.95) +
geom_ribbon(data = typ.mean[typ.mean$temp.c >= 30,],aes(ymin = -Inf, ymax = Inf), colour = "grey", alpha = 0.5) +
xlab("1/(K T)")+
ylab("log of metabolic trait")
#plot(-1/(K*(273.15+typ.mean$temp.c)), typ.mean$mean.log.r)
ggplot(data = typ.mean, aes(x = 1/(K*(273.15+temp.c)), y = mean.log.r)) +
geom_point() +
theme_set(theme_bw()) +
theme_classic() +
theme(panel.grid.major = element_line(colour = NA), panel.border = element_blank(),
axis.title.x = element_text(size = 17),
axis.title.y = element_text(size = 17)) +
stat_smooth(data = typ.mean[typ.mean$temp.c <= 30,],method = 'lm', formula = 'y~x',se = FALSE) +
geom_text(x = 39.5, y = -5, label = lm_eqn(typ.mean), parse = TRUE, size = 5) +
geom_ribbon(data = typ.mean[typ.mean$temp.c >= 30,],aes(ymin = -Inf, ymax = Inf), colour = "grey", alpha = 0.5) +
xlab("1/(K T)")+
ylab("log of metabolic trait")
lm_eqn <- function(df){
m <- fit.r.spe;
eq <- substitute(italic(y) == a - b %.% italic(x)*","~~italic(r)^2~"="~r2,
list(a = format(unname(coef(m)[1]), digits = 2),
b = format(unname(coef(m)[2]), digits = 2),
r2 = format(summary(m)$r.squared, digits = 3)))
as.character(as.expression(eq));
}
#plot(-1/(K*(273.15+typ.mean$temp.c)), typ.mean$mean.log.r)
ggplot(data = typ.mean, aes(x = 1/(K*(273.15+temp.c)), y = mean.log.r)) +
geom_point() +
theme_set(theme_bw()) +
theme_classic() +
theme(panel.grid.major = element_line(colour = NA), panel.border = element_blank(),
axis.title.x = element_text(size = 17),
axis.title.y = element_text(size = 17)) +
stat_smooth(data = typ.mean[typ.mean$temp.c <= 30,],method = 'lm', formula = 'y~x',se = FALSE) +
geom_text(x = 39.5, y = -5, label = lm_eqn(typ.mean), parse = TRUE, size = 5) +
geom_ribbon(data = typ.mean[typ.mean$temp.c >= 30,],aes(ymin = -Inf, ymax = Inf), colour = "grey", alpha = 0.5) +
xlab("1/(K T)")+
ylab("log of metabolic trait")
eq <- substitute(italic(y) == a - b % % italic(x)*","~~italic(r)^2~"="~r2,
list(a = format(unname(coef(m)[1]), digits = 2),
b = format(unname(coef(m)[2]), digits = 2),
r2 = format(summary(m)$r.squared, digits = 3)))
lm_eqn <- function(df){
m <- fit.r.spe;
eq <- substitute(italic(y) == a - b % % italic(x)*","~~italic(r)^2~"="~r2,
list(a = format(unname(coef(m)[1]), digits = 2),
b = format(unname(coef(m)[2]), digits = 2),
r2 = format(summary(m)$r.squared, digits = 3)))
as.character(as.expression(eq));
}
#plot(-1/(K*(273.15+typ.mean$temp.c)), typ.mean$mean.log.r)
ggplot(data = typ.mean, aes(x = 1/(K*(273.15+temp.c)), y = mean.log.r)) +
geom_point() +
theme_set(theme_bw()) +
theme_classic() +
theme(panel.grid.major = element_line(colour = NA), panel.border = element_blank(),
axis.title.x = element_text(size = 17),
axis.title.y = element_text(size = 17)) +
stat_smooth(data = typ.mean[typ.mean$temp.c <= 30,],method = 'lm', formula = 'y~x',se = FALSE) +
geom_text(x = 39.5, y = -5, label = lm_eqn(typ.mean), parse = TRUE, size = 5) +
geom_ribbon(data = typ.mean[typ.mean$temp.c >= 30,],aes(ymin = -Inf, ymax = Inf), colour = "grey", alpha = 0.5) +
xlab("1/(K T)")+
ylab("log of metabolic trait")
eq <- substitute(italic(y) == a - b italic(x)*","~~italic(r)^2~"="~r2,
list(a = format(unname(coef(m)[1]), digits = 2),
b = format(unname(coef(m)[2]), digits = 2),
r2 = format(summary(m)$r.squared, digits = 3)))
lm_eqn <- function(df){
m <- fit.r.spe;
eq <- substitute(italic(y) == a - b italic(x)*","~~italic(r)^2~"="~r2,
list(a = format(unname(coef(m)[1]), digits = 2),
b = format(unname(coef(m)[2]), digits = 2),
r2 = format(summary(m)$r.squared, digits = 3)))
as.character(as.expression(eq));
}
lm_eqn <- function(df){
m <- fit.r.spe;
eq <- substitute(italic(y) == a - b ~ italic(x)*","~~italic(r)^2~"="~r2,
list(a = format(unname(coef(m)[1]), digits = 2),
b = format(unname(coef(m)[2]), digits = 2),
r2 = format(summary(m)$r.squared, digits = 3)))
as.character(as.expression(eq));
}
#plot(-1/(K*(273.15+typ.mean$temp.c)), typ.mean$mean.log.r)
ggplot(data = typ.mean, aes(x = 1/(K*(273.15+temp.c)), y = mean.log.r)) +
geom_point() +
theme_set(theme_bw()) +
theme_classic() +
theme(panel.grid.major = element_line(colour = NA), panel.border = element_blank(),
axis.title.x = element_text(size = 17),
axis.title.y = element_text(size = 17)) +
stat_smooth(data = typ.mean[typ.mean$temp.c <= 30,],method = 'lm', formula = 'y~x',se = FALSE) +
geom_text(x = 39.5, y = -5, label = lm_eqn(typ.mean), parse = TRUE, size = 5) +
geom_ribbon(data = typ.mean[typ.mean$temp.c >= 30,],aes(ymin = -Inf, ymax = Inf), colour = "grey", alpha = 0.5) +
xlab("1/(K T)")+
ylab("log of metabolic trait")
lm_eqn <- function(df){
m <- fit.r.spe;
eq <- substitute(italic(y) == a - b ~ italic(x)*","~~italic(r)^2~"="~r2,
list(a = format(unname(coef(m)[1]), digits = 4),
b = format(unname(coef(m)[2]), digits = 2),
r2 = format(summary(m)$r.squared, digits = 3)))
as.character(as.expression(eq));
}
#plot(-1/(K*(273.15+typ.mean$temp.c)), typ.mean$mean.log.r)
ggplot(data = typ.mean, aes(x = 1/(K*(273.15+temp.c)), y = mean.log.r)) +
geom_point() +
theme_set(theme_bw()) +
theme_classic() +
theme(panel.grid.major = element_line(colour = NA), panel.border = element_blank(),
axis.title.x = element_text(size = 17),
axis.title.y = element_text(size = 17)) +
stat_smooth(data = typ.mean[typ.mean$temp.c <= 30,],method = 'lm', formula = 'y~x',se = FALSE) +
geom_text(x = 39.5, y = -5, label = lm_eqn(typ.mean), parse = TRUE, size = 5) +
geom_ribbon(data = typ.mean[typ.mean$temp.c >= 30,],aes(ymin = -Inf, ymax = Inf), colour = "grey", alpha = 0.5) +
xlab("1/(K T)")+
ylab("log of metabolic trait")
typ.mean
#plot(-1/(K*(273.15+typ.mean$temp.c)), typ.mean$mean.log.r)
ggplot(data = typ.mean[typ.mean$temp.c != 12,], aes(x = 1/(K*(273.15+temp.c)), y = mean.log.r)) +
geom_point() +
theme_set(theme_bw()) +
theme_classic() +
theme(panel.grid.major = element_line(colour = NA), panel.border = element_blank(),
axis.title.x = element_text(size = 17),
axis.title.y = element_text(size = 17)) +
stat_smooth(data = typ.mean[typ.mean$temp.c <= 30,],method = 'lm', formula = 'y~x',se = FALSE) +
geom_text(x = 39.5, y = -5, label = lm_eqn(typ.mean), parse = TRUE, size = 5) +
geom_ribbon(data = typ.mean[typ.mean$temp.c >= 30,],aes(ymin = -Inf, ymax = Inf), colour = "grey", alpha = 0.5) +
xlab("1/(K T)")+
ylab("log of metabolic trait")
#plot(-1/(K*(273.15+typ.mean$temp.c)), typ.mean$mean.log.r)
ggplot(data = typ.mean[typ.mean$temp.c != 12,], aes(x = 1/(K*(273.15+temp.c)), y = mean.log.r)) +
geom_point() +
theme_set(theme_bw()) +
theme_classic() +
theme(panel.grid.major = element_line(colour = NA), panel.border = element_blank(),
axis.title.x = element_text(size = 17),
axis.title.y = element_text(size = 17)) +
stat_smooth(data = typ.mean[typ.mean$temp.c <= 30,],method = 'lm', formula = 'y~x',se = FALSE) +
geom_text(x = 39.5, y = -5, label = lm_eqn(typ.mean), parse = TRUE, size = 5) +
geom_ribbon(data = typ.mean[typ.mean$temp.c >= 30,],aes(ymin = -Inf, ymax = Inf), colour = "grey", alpha = 0.5) +
xlab("1/(K T)")+
ylab("log of metabolic trait")
lm_eqn <- function(df){
m <- lm(typ.mean[typ.mean$temp.c != 12,], formula = log.r ~ -1/(K*(temp.c+273.15)))
# fit.r.spe;
eq <- substitute(italic(y) == a - b ~ italic(x)*","~~italic(r)^2~"="~r2,
list(a = format(unname(coef(m)[1]), digits = 4),
b = format(unname(coef(m)[2]), digits = 2),
r2 = format(summary(m)$r.squared, digits = 3)))
as.character(as.expression(eq));
}
#plot(-1/(K*(273.15+typ.mean$temp.c)), typ.mean$mean.log.r)
ggplot(data = typ.mean[typ.mean$temp.c != 12,], aes(x = 1/(K*(273.15+temp.c)), y = mean.log.r)) +
geom_point() +
theme_set(theme_bw()) +
theme_classic() +
theme(panel.grid.major = element_line(colour = NA), panel.border = element_blank(),
axis.title.x = element_text(size = 17),
axis.title.y = element_text(size = 17)) +
stat_smooth(data = typ.mean[typ.mean$temp.c <= 30,],method = 'lm', formula = 'y~x',se = FALSE) +
geom_text(x = 39.5, y = -5, label = lm_eqn(typ.mean), parse = TRUE, size = 5) +
geom_ribbon(data = typ.mean[typ.mean$temp.c >= 30,],aes(ymin = -Inf, ymax = Inf), colour = "grey", alpha = 0.5) +
xlab("1/(K T)")+
ylab("log of metabolic trait")
lm_eqn <- function(df){
m <- lm(df, formula = log.r ~ -1/(K*(temp.c+273.15)))
# fit.r.spe;
eq <- substitute(italic(y) == a - b ~ italic(x)*","~~italic(r)^2~"="~r2,
list(a = format(unname(coef(m)[1]), digits = 4),
b = format(unname(coef(m)[2]), digits = 2),
r2 = format(summary(m)$r.squared, digits = 3)))
as.character(as.expression(eq));
}
#plot(-1/(K*(273.15+typ.mean$temp.c)), typ.mean$mean.log.r)
ggplot(data = typ.mean[typ.mean$temp.c != 12,], aes(x = 1/(K*(273.15+temp.c)), y = mean.log.r)) +
geom_point() +
theme_set(theme_bw()) +
theme_classic() +
theme(panel.grid.major = element_line(colour = NA), panel.border = element_blank(),
axis.title.x = element_text(size = 17),
axis.title.y = element_text(size = 17)) +
stat_smooth(data = typ.mean[typ.mean$temp.c <= 30,],method = 'lm', formula = 'y~x',se = FALSE) +
geom_text(x = 39.5, y = -5, label = lm_eqn(typ.mean[typ.mean$temp.c != 12,]), parse = TRUE, size = 5) +
geom_ribbon(data = typ.mean[typ.mean$temp.c >= 30,],aes(ymin = -Inf, ymax = Inf), colour = "grey", alpha = 0.5) +
xlab("1/(K T)")+
ylab("log of metabolic trait")
typ.mean[typ.mean$temp.c != 12,]
lm_eqn(typ.mean[typ.mean$temp.c != 12,])
lm(typ.mean, formula = log.r ~ -1/(K*(temp.c+273.15)))
lmfit <- lm(df, formula = log.r ~ -1/(K*(temp.c+273.15)))
lmfit <- lm(typ.mean[typ.mean$temp.c != 12,], formula = log.r ~ -1/(K*(temp.c+273.15)))
typ.mean[typ.mean$temp.c != 12,]
typ.mean$mi.one.over.KT <- -1/(K*(typ.mean$temp.c+273.15))
lm_eqn <- function(df){
m <- lm(df, formula = log.r ~ mi.one.over.KT)
eq <- substitute(italic(y) == a - b ~ italic(x)*","~~italic(r)^2~"="~r2,
list(a = format(unname(coef(m)[1]), digits = 4),
b = format(unname(coef(m)[2]), digits = 2),
r2 = format(summary(m)$r.squared, digits = 3)))
as.character(as.expression(eq));
}
lm_eqn(typ.mean[typ.mean$temp.c != 12,])
lm_eqn <- function(df){
m <- lm(df, formula = mean.log.r ~ mi.one.over.KT)
eq <- substitute(italic(y) == a - b ~ italic(x)*","~~italic(r)^2~"="~r2,
list(a = format(unname(coef(m)[1]), digits = 4),
b = format(unname(coef(m)[2]), digits = 2),
r2 = format(summary(m)$r.squared, digits = 3)))
as.character(as.expression(eq));
}
#plot(-1/(K*(273.15+typ.mean$temp.c)), typ.mean$mean.log.r)
ggplot(data = typ.mean[typ.mean$temp.c != 12,], aes(x = 1/(K*(273.15+temp.c)), y = mean.log.r)) +
geom_point() +
theme_set(theme_bw()) +
theme_classic() +
theme(panel.grid.major = element_line(colour = NA), panel.border = element_blank(),
axis.title.x = element_text(size = 17),
axis.title.y = element_text(size = 17)) +
stat_smooth(data = typ.mean[typ.mean$temp.c <= 30,],method = 'lm', formula = 'y~x',se = FALSE) +
geom_text(x = 39.5, y = -5, label = lm_eqn(typ.mean[typ.mean$temp.c != 12,]), parse = TRUE, size = 5) +
geom_ribbon(data = typ.mean[typ.mean$temp.c >= 30,],aes(ymin = -Inf, ymax = Inf), colour = "grey", alpha = 0.5) +
xlab("1/(K T)")+
ylab("log of metabolic trait")
typ.mean
#plot(-1/(K*(273.15+typ.mean$temp.c)), typ.mean$mean.log.r)
plot.mean <- subset(typ.mean, typ.mean$temp.c != 30 $ typ.mean$temp.c != 12)
#plot(-1/(K*(273.15+typ.mean$temp.c)), typ.mean$mean.log.r)
plot.mean <- subset(typ.mean, typ.mean$temp.c != 30 & typ.mean$temp.c != 12)
ggplot(data = plot.mean, aes(x = 1/(K*(273.15+temp.c)), y = mean.log.r)) +
geom_point() +
theme_set(theme_bw()) +
theme_classic() +
theme(panel.grid.major = element_line(colour = NA), panel.border = element_blank(),
axis.title.x = element_text(size = 17),
axis.title.y = element_text(size = 17)) +
stat_smooth(data = typ.mean[typ.mean$temp.c <= 30,],method = 'lm', formula = 'y~x',se = FALSE) +
geom_text(x = 39.5, y = -5, label = lm_eqn(plot.mean), parse = TRUE, size = 5) +
geom_ribbon(data = typ.mean[typ.mean$temp.c >= 30,],aes(ymin = -Inf, ymax = Inf), colour = "grey", alpha = 0.5) +
xlab("1/(K T)")+
ylab("log of metabolic trait")
#plot(-1/(K*(273.15+typ.mean$temp.c)), typ.mean$mean.log.r)
plot.mean <- subset(typ.mean, typ.mean$temp.c != 0 & typ.mean$temp.c != 12)
ggplot(data = plot.mean, aes(x = 1/(K*(273.15+temp.c)), y = mean.log.r)) +
geom_point() +
theme_set(theme_bw()) +
theme_classic() +
theme(panel.grid.major = element_line(colour = NA), panel.border = element_blank(),
axis.title.x = element_text(size = 17),
axis.title.y = element_text(size = 17)) +
stat_smooth(data = typ.mean[typ.mean$temp.c <= 30,],method = 'lm', formula = 'y~x',se = FALSE) +
geom_text(x = 39.5, y = -5, label = lm_eqn(plot.mean), parse = TRUE, size = 5) +
geom_ribbon(data = typ.mean[typ.mean$temp.c >= 30,],aes(ymin = -Inf, ymax = Inf), colour = "grey", alpha = 0.5) +
xlab("1/(K T)")+
ylab("log of metabolic trait")
#plot(-1/(K*(273.15+typ.mean$temp.c)), typ.mean$mean.log.r)
plot.mean <- subset(typ.mean, typ.mean$temp.c != 12)
ggplot(data = plot.mean, aes(x = 1/(K*(273.15+temp.c)), y = mean.log.r)) +
geom_point() +
theme_set(theme_bw()) +
theme_classic() +
theme(panel.grid.major = element_line(colour = NA), panel.border = element_blank(),
axis.title.x = element_text(size = 17),
axis.title.y = element_text(size = 17)) +
stat_smooth(data = typ.mean[typ.mean$temp.c <= 30,],method = 'lm', formula = 'y~x',se = FALSE) +
geom_text(x = 39.5, y = -5, label = lm_eqn(plot.mean), parse = TRUE, size = 5) +
geom_ribbon(data = typ.mean[typ.mean$temp.c >= 30,],aes(ymin = -Inf, ymax = Inf), colour = "grey", alpha = 0.5) +
xlab("1/(K T)")+
ylab("log of metabolic trait")
typ_arrhe_fit <- ggplot(data = plot.mean, aes(x = 1/(K*(273.15+temp.c)), y = mean.log.r)) +
geom_point() +
theme_set(theme_bw()) +
theme_classic() +
theme(panel.grid.major = element_line(colour = NA), panel.border = element_blank(),
axis.title.x = element_text(size = 17),
axis.title.y = element_text(size = 17)) +
stat_smooth(data = typ.mean[typ.mean$temp.c <= 30,],method = 'lm', formula = 'y~x',se = FALSE) +
geom_text(x = 39.5, y = -5, label = lm_eqn(plot.mean), parse = TRUE, size = 5) +
geom_ribbon(data = typ.mean[typ.mean$temp.c >= 30,],aes(ymin = -Inf, ymax = Inf), colour = "grey", alpha = 0.5) +
xlab("1/(K T)")+
ylab("log of metabolic trait")
typ_arrhe_fit
# geom_errorbar(aes(ymin = mean.log.r - CI.r, ymax = mean.log.r + CI.r, width = .1)) +
# geom_errorbar(aes(xmin = mean.temp.c - CI.temp.c, xmax = mean.temp.c + CI.temp.c, width = .1)) +
# geom_vline(xintercept=30, linetype="dashed", color = "black") +
# labs(y="log(tlag)(1/h) +/- CI ", x = "Mean of -1/KT(eV) +/- CI ") +
# geom_ribbon(data = dat[dat$mean.temp.c >= 27,], aes(ymin = -Inf, ymax = Inf, alpha = .3)) +
save_plot("../results/typ_arrhe_fit",typ_arrhe_fit)
lm_eqn <- function(df){
m <- lm(df, formula = mean.log.r ~ mi.one.over.KT)
eq <- substitute(y == a - b ~ x*","~~r^2~"="~r2,
list(a = format(unname(coef(m)[1]), digits = 4),
b = format(unname(coef(m)[2]), digits = 2),
r2 = format(summary(m)$r.squared, digits = 3)))
as.character(as.expression(eq));
}
#plot(-1/(K*(273.15+typ.mean$temp.c)), typ.mean$mean.log.r)
plot.mean <- subset(typ.mean, typ.mean$temp.c != 12)
typ_arrhe_fit <- ggplot(data = plot.mean, aes(x = 1/(K*(273.15+temp.c)), y = mean.log.r)) +
geom_point() +
theme_set(theme_bw()) +
theme_classic() +
theme(panel.grid.major = element_line(colour = NA), panel.border = element_blank(),
axis.title.x = element_text(size = 17),
axis.title.y = element_text(size = 17)) +
stat_smooth(data = typ.mean[typ.mean$temp.c <= 30,],method = 'lm', formula = 'y~x',se = FALSE) +
geom_text(x = 39.5, y = -5, label = lm_eqn(plot.mean), parse = TRUE, size = 5) +
geom_ribbon(data = typ.mean[typ.mean$temp.c >= 30,],aes(ymin = -Inf, ymax = Inf), colour = "grey", alpha = 0.5) +
xlab("1/(K T)")+
ylab("log of metabolic trait")
typ_arrhe_fit
typ_arrhe_fit <- ggplot(data = plot.mean, aes(x = 1/(K*(273.15+temp.c)), y = mean.log.r)) +
geom_point() +
theme_set(theme_bw()) +
theme_classic() +
theme(panel.grid.major = element_line(colour = NA), panel.border = element_blank(),
axis.title.x = element_text(size = 17),
axis.title.y = element_text(size = 17)) +
stat_smooth(data = typ.mean[typ.mean$temp.c <= 30,],method = 'lm', formula = 'y~x',se = FALSE) +
geom_text(x = 39.5, y = -5, label = lm_eqn(plot.mean), parse = TRUE, size = 5.5) +
geom_ribbon(data = typ.mean[typ.mean$temp.c >= 30,],aes(ymin = -Inf, ymax = Inf), colour = "grey", alpha = 0.5) +
xlab("1/(K T)")+
ylab("log of metabolic trait")
typ_arrhe_fit
typ_arrhe_fit <- ggplot(data = plot.mean, aes(x = 1/(K*(273.15+temp.c)), y = mean.log.r)) +
geom_point() +
theme_set(theme_bw()) +
theme_classic() +
theme(panel.grid.major = element_line(colour = NA), panel.border = element_blank(),
axis.title.x = element_text(size = 17),
axis.title.y = element_text(size = 17)) +
stat_smooth(data = typ.mean[typ.mean$temp.c <= 30,],method = 'lm', formula = 'y~x',se = FALSE) +
geom_text(x = 39.5, y = -5, label = lm_eqn(plot.mean), parse = TRUE, size = 5) +
geom_ribbon(data = typ.mean[typ.mean$temp.c >= 30,],aes(ymin = -Inf, ymax = Inf), colour = "grey", alpha = 0.5) +
xlab("1/(K T)")+
ylab("log of metabolic trait")
typ_arrhe_fit
# geom_errorbar(aes(ymin = mean.log.r - CI.r, ymax = mean.log.r + CI.r, width = .1)) +
# geom_errorbar(aes(xmin = mean.temp.c - CI.temp.c, xmax = mean.temp.c + CI.temp.c, width = .1)) +
# geom_vline(xintercept=30, linetype="dashed", color = "black") +
# labs(y="log(tlag)(1/h) +/- CI ", x = "Mean of -1/KT(eV) +/- CI ") +
# geom_ribbon(data = dat[dat$mean.temp.c >= 27,], aes(ymin = -Inf, ymax = Inf, alpha = .3)) +
save_plot("../results/typ_arrhe_fit",typ_arrhe_fit)
#legend <- paste0('AICc = ', info.id$AICc, '\nAIC = ', info.id$AIC,
#                 '\nBIC = ', info.id$BIC, '\nRsquare = ', info.id$rsq)
legend <- "AICc = -330.10\nAIC = -331.01\nBIC = -321.55" #\nR^2 = 0.95
pdf(file = "../results/typ_gomp_fit.pdf")
p <- ggplot(typ.data, aes(x = Time, y = logN)) +
geom_point() +
labs(x = "Time (h)", y = "Log of Population Size (log(N))") +
# ggtitle("Typical Gompertz Model Fit") +
geom_line(data = plot.id, aes(x = time, y = plot.point), size=1) +
theme_set(theme_bw()) +
theme_classic() +
theme(panel.grid.major = element_line(colour = NA),
axis.title.x = element_text(size=17),
axis.title.y = element_text(size=17)) +
#legend.position=c(3.5,0.39)
annotate('text', label = legend, x = 17, y = -2.3, hjust = 0, vjust = 0, size = 4.6)
print(p)
graphics.off()
p
